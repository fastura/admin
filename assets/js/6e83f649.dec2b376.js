"use strict";(self.webpackChunkfastura=self.webpackChunkfastura||[]).push([[925],{4137:(e,a,t)=>{t.d(a,{Zo:()=>c,kt:()=>k});var r=t(7294);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function p(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=r.createContext({}),l=function(e){var a=r.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},c=function(e){var a=l(e.components);return r.createElement(s.Provider,{value:a},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},u=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=l(t),u=n,k=d["".concat(s,".").concat(u)]||d[u]||m[u]||o;return t?r.createElement(k,i(i({ref:a},c),{},{components:t})):r.createElement(k,i({ref:a},c))}));function k(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var o=t.length,i=new Array(o);i[0]=u;var p={};for(var s in a)hasOwnProperty.call(a,s)&&(p[s]=a[s]);p.originalType=e,p[d]="string"==typeof e?e:n,i[1]=p;for(var l=2;l<o;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5577:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var r=t(7462),n=(t(7294),t(4137));const o={},i="Limpiar inodes",p={unversionedId:"Administrador/Limpiar-inodes",id:"Administrador/Limpiar-inodes",title:"Limpiar inodes",description:"En un sistema de archivos GNU/Linux, un inodo es una estructura de datos que almacena informaci\xf3n sobre un archivo o directorio, como los permisos, el propietario, la ubicaci\xf3n en el disco, etc. Cuando los inodos est\xe1n llenos, puedes experimentar problemas de falta de espacio en disco, incluso si a\xfan queda espacio disponible en t\xe9rminos de capacidad de almacenamiento.",source:"@site/docs/Administrador/10-Limpiar-inodes.md",sourceDirName:"Administrador",slug:"/Administrador/Limpiar-inodes",permalink:"/admin/Administrador/Limpiar-inodes",draft:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Incrementar espacio en disco",permalink:"/admin/Administrador/Incrementar-espacio-en-disco"},next:{title:"API REST documentaci\xf3n",permalink:"/admin/api-rest-documentacion"}},s={},l=[{value:"Limpieza autom\xe1tica de inodos (script Bash)",id:"limpieza-autom\xe1tica-de-inodos-script-bash",level:2}],c={toc:l},d="wrapper";function m(e){let{components:a,...o}=e;return(0,n.kt)(d,(0,r.Z)({},c,o,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"limpiar-inodes"},"Limpiar inodes"),(0,n.kt)("p",null,"En un sistema de archivos GNU/Linux, un inodo es una estructura de datos que almacena informaci\xf3n sobre un archivo o directorio, como los permisos, el propietario, la ubicaci\xf3n en el disco, etc. Cuando los inodos est\xe1n llenos, puedes experimentar problemas de falta de espacio en disco, incluso si a\xfan queda espacio disponible en t\xe9rminos de capacidad de almacenamiento."),(0,n.kt)("p",null,"Pasos para realizar una limpieza manual de inodos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Realizar un backup de datos (opcional pero recomendado):")," Antes de comenzar, es una buena pr\xe1ctica realizar una copia de seguridad de tus datos. En servicios como Google Cloud o AWS, puedes crear un snapshot o instant\xe1nea de tu instancia.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Verificar el espacio en disco:")," Para verificar el espacio en disco, utiliza el siguiente comando:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"df -h\n")),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"Alt text",src:t(2439).Z,width:"1151",height:"586"})),(0,n.kt)("p",{parentName:"li"},"Para verificar la utilizaci\xf3n de inodos:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"df -i\n")),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"Alt text",src:t(3402).Z,width:"1058",height:"709"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Limpieza manual de inodos:")," Si los inodos est\xe1n al 100% de capacidad, sigue estos pasos para limpiarlos:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Realiza un backup de tus datos:")," Si est\xe1s en Google Cloud o AWS, puedes crear un snapshot o instant\xe1nea como respaldo.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Accede a la ra\xedz de tu servidor:")," Ejecuta el siguiente comando para navegar a la ra\xedz:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd/\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Contar la utilizaci\xf3n de inodos:")," Utiliza este comando para identificar el directorio que tiene el valor m\xe1s alto de inodos:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'find . -printf "%h\\n" | cut -d/ -f-2 | sort | uniq -c | sort -rn\n')),(0,n.kt)("p",{parentName:"li"},"El directorio con el valor m\xe1s alto es el que contiene la mayor cantidad de inodos.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Accede al directorio con inodos altos:")," Por ejemplo, si /var tiene un valor alto, accede a ese directorio y ejecuta nuevamente el comando del paso anterior.\n",(0,n.kt)("img",{alt:"Alt text",src:t(8842).Z,width:"948",height:"686"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Identifica subdirectorios con alto uso de inodos:")," Contin\xfaa accediendo a directorios m\xe1s profundos y ejecuta el mismo comando del paso anterior hasta identificar los subdirectorios problem\xe1ticos.\n",(0,n.kt)("img",{alt:"Alt text",src:t(3569).Z,width:"1447",height:"299"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Det\xe9n los contenedores y el proxy de Docker:")," Si utilizas Docker, det\xe9n todos los contenedores y el proxy con los siguientes comandos:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Para los contenedores en tu proyecto:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /ruta/del/proyecto\ndocker-compose down\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Si no puedes detener los servicios, usa:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker stop $(docker ps -a -q)\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Para el proxy (si aplicable):"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /root/proxy\ndocker-compose down\n"))))))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Reinicia Docker:")," Ejecuta el siguiente comando para reiniciar Docker:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"service docker restart\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Limpieza autom\xe1tica de Docker:")," Ejecuta el siguiente comando para realizar una limpieza de Docker:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker system prune\n")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'Confirma la acci\xf3n escribiendo "Y". Este proceso puede llevar tiempo.'))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Verifica el espacio de inodos nuevamente:")," Ejecuta"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"df -i\n")),(0,n.kt)("p",{parentName:"li"},"Para asegurarte de que el valor de la columna IUse % haya disminuido.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Inicia nuevamente los contenedores y el proxy:")," Si todo est\xe1 en orden, inicia los contenedores y el proxy nuevamente."),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Para el proxy:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /root/proxy\ndocker-compose up -d\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Para los contenedores en tu proyecto:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /ruta/del/proyecto\ndocker-compose up -d\n")))))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Verifica el estado de los contenedores: Ejecuta docker ps para asegurarte de que los contenedores est\xe9n en funcionamiento y verifica que tu proyecto funcione correctamente.")),(0,n.kt)("h2",{id:"limpieza-autom\xe1tica-de-inodos-script-bash"},"Limpieza autom\xe1tica de inodos (script Bash)"),(0,n.kt)("p",null,"Si deseas automatizar este proceso, puedes seguir estos pasos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Accede como superusuario:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo su\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Utiliza ",(0,n.kt)("inlineCode",{parentName:"p"},"nano")," u otro editor de texto para crear y pegar el siguiente script:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"nano docker-prune.sh\n")),(0,n.kt)("p",{parentName:"li"},"Pega el contenido del ",(0,n.kt)("strong",{parentName:"p"},"script"),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Edita la ruta de tu proyecto en la l\xednea 38 o cerca:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd $HOME/[nombre_del_proyecto]\n")),(0,n.kt)("p",{parentName:"li"},"Aseg\xfarate de especificar la ruta correcta de tu proyecto.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Guarda el archivo presionando Ctrl + X, confirma que deseas guardar y cierra el editor.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Asigna permisos ejecutables al archivo:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"chmod +x docker-prune.sh\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Ejecuta el script:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"./docker-prune.sh\n")))),(0,n.kt)("p",null,"Este script automatizar\xe1 el proceso de limpieza de inodos, lo que facilitar\xe1 la administraci\xf3n del espacio en disco en el futuro."))}m.isMDXComponent=!0},2439:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/inodes-1-2966fbad8e2d5bfa9b5cf8b69a0e7ad4.jpg"},3402:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/inodes-2-7c2de6d6021d1180c0787b48a7e31e5d.jpg"},8842:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/inodes-3-5a3c29ab3461bd43352b01cec42d53b0.jpg"},3569:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/inodes-4-e7531478b8772e71d4ef78c6059df6c4.jpg"}}]);